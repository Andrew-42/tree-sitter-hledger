{
  "$schema": "https://tree-sitter.github.io/tree-sitter/assets/schemas/grammar.schema.json",
  "name": "hledger",
  "rules": {
    "source_file": {
      "type": "REPEAT",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SYMBOL",
            "name": "journal_item"
          },
          {
            "type": "SYMBOL",
            "name": "_newline"
          }
        ]
      }
    },
    "journal_item": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "transaction"
        },
        {
          "type": "SYMBOL",
          "name": "directive"
        },
        {
          "type": "SYMBOL",
          "name": "block_comment"
        },
        {
          "type": "SYMBOL",
          "name": "top_comment"
        }
      ]
    },
    "transaction": {
      "type": "PREC_LEFT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "SYMBOL",
            "name": "date"
          },
          {
            "type": "SYMBOL",
            "name": "transaction_heading"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "_sep_comment"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "_newline"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "SYMBOL",
              "name": "posting"
            }
          }
        ]
      }
    },
    "transaction_heading": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "status"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "code"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "payee"
                },
                {
                  "type": "SYMBOL",
                  "name": "_whitespace"
                },
                {
                  "type": "STRING",
                  "value": "|"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_whitespace"
            },
            {
              "type": "SYMBOL",
              "name": "note"
            }
          ]
        }
      ]
    },
    "note": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "\\S+(?: \\S+)*"
      }
    },
    "status": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "*"
        },
        {
          "type": "STRING",
          "value": "!"
        }
      ]
    },
    "code": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "PATTERN",
          "value": "[^)]*"
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "posting": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "comment"
            },
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "account"
                },
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "SEQ",
                      "members": [
                        {
                          "type": "SYMBOL",
                          "name": "_spacer"
                        },
                        {
                          "type": "SYMBOL",
                          "name": "_cost_amount"
                        },
                        {
                          "type": "CHOICE",
                          "members": [
                            {
                              "type": "SYMBOL",
                              "name": "_assert_amount"
                            },
                            {
                              "type": "BLANK"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "BLANK"
                    }
                  ]
                },
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "SYMBOL",
                      "name": "_sep_comment"
                    },
                    {
                      "type": "BLANK"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "_newline"
        }
      ]
    },
    "_assert_amount": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_whitechar"
        },
        {
          "type": "SYMBOL",
          "name": "assert"
        },
        {
          "type": "SYMBOL",
          "name": "_whitechar"
        },
        {
          "type": "SYMBOL",
          "name": "_cost_amount"
        }
      ]
    },
    "_cost_amount": {
      "type": "PREC_RIGHT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "SYMBOL",
            "name": "amount"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "_whitechar"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "cost"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "_whitechar"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "amount"
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          }
        ]
      }
    },
    "cost": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "STRING",
            "value": "@@"
          },
          {
            "type": "STRING",
            "value": "@"
          }
        ]
      }
    },
    "assert": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "STRING",
            "value": "==*"
          },
          {
            "type": "STRING",
            "value": "=="
          },
          {
            "type": "STRING",
            "value": "=*"
          },
          {
            "type": "STRING",
            "value": "="
          }
        ]
      }
    },
    "directive": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "include_directive"
        },
        {
          "type": "SYMBOL",
          "name": "decimal_mark_directive"
        },
        {
          "type": "SYMBOL",
          "name": "tag_directive"
        },
        {
          "type": "SYMBOL",
          "name": "commodity_directive"
        },
        {
          "type": "SYMBOL",
          "name": "price_directive"
        },
        {
          "type": "SYMBOL",
          "name": "payee_directive"
        },
        {
          "type": "SYMBOL",
          "name": "account_directive"
        }
      ]
    },
    "include_directive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "include"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "file_path"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_sep_comment"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "decimal_mark_directive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "decimal-mark"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "."
            },
            {
              "type": "STRING",
              "value": ","
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_sep_comment"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "tag_directive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "tag"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "tag"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_sep_comment"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "tag": {
      "type": "PATTERN",
      "value": "[^\\s; ]+"
    },
    "commodity_directive": {
      "type": "PREC",
      "value": 1,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "commodity"
          },
          {
            "type": "SYMBOL",
            "name": "_whitespace"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "commodity"
              },
              {
                "type": "SYMBOL",
                "name": "amount"
              }
            ]
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "_sep_comment"
              },
              {
                "type": "BLANK"
              }
            ]
          }
        ]
      }
    },
    "price_directive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "P"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "date"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "commodity"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_sep_comment"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "payee_directive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "payee"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "payee"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_sep_comment"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "payee": {
      "type": "PATTERN",
      "value": "[^\\r\\n\\s]+( [^\\r\\n\\s]+)*"
    },
    "account_directive": {
      "type": "PREC_LEFT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "STRING",
            "value": "account"
          },
          {
            "type": "SYMBOL",
            "name": "_whitespace"
          },
          {
            "type": "SYMBOL",
            "name": "account"
          },
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "_sep_comment"
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "SYMBOL",
            "name": "_newline"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "SYMBOL",
              "name": "account_subdirective"
            }
          }
        ]
      }
    },
    "account": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[^;\\s]+(?: \\S+)*"
      }
    },
    "account_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "alias_subdirective"
            },
            {
              "type": "SYMBOL",
              "name": "note_subdirective"
            },
            {
              "type": "SYMBOL",
              "name": "check_subdirective"
            },
            {
              "type": "SYMBOL",
              "name": "assert_subdirective"
            },
            {
              "type": "SYMBOL",
              "name": "type_subdirective"
            },
            {
              "type": "SYMBOL",
              "name": "comment"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "_newline"
        }
      ]
    },
    "alias_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "alias"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "PATTERN",
          "value": "[^\\s;]+"
        }
      ]
    },
    "note_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "note"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "PATTERN",
          "value": "[^;\\r\\n]+"
        }
      ]
    },
    "check_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "check"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "PATTERN",
          "value": "[^;\\r\\n]+"
        }
      ]
    },
    "assert_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "assert"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "PATTERN",
          "value": "[^;\\r\\n]+"
        }
      ]
    },
    "type_subdirective": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "type"
        },
        {
          "type": "SYMBOL",
          "name": "_whitespace"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "A"
            },
            {
              "type": "STRING",
              "value": "L"
            },
            {
              "type": "STRING",
              "value": "E"
            },
            {
              "type": "STRING",
              "value": "R"
            },
            {
              "type": "STRING",
              "value": "X"
            },
            {
              "type": "STRING",
              "value": "C"
            },
            {
              "type": "STRING",
              "value": "V"
            }
          ]
        }
      ]
    },
    "amount": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "commodity"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitechar"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "quantity"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "commodity"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitechar"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "neg_quantity"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "quantity"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitechar"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "commodity"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "neg_quantity"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_whitechar"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "commodity"
            }
          ]
        }
      ]
    },
    "_digit": {
      "type": "PATTERN",
      "value": "\\d"
    },
    "_number": {
      "type": "PREC_LEFT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "SYMBOL",
            "name": "_digit"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SEQ",
                  "members": [
                    {
                      "type": "CHOICE",
                      "members": [
                        {
                          "type": "STRING",
                          "value": " "
                        },
                        {
                          "type": "STRING",
                          "value": ","
                        },
                        {
                          "type": "STRING",
                          "value": "."
                        }
                      ]
                    },
                    {
                      "type": "SYMBOL",
                      "name": "_digit"
                    }
                  ]
                },
                {
                  "type": "SYMBOL",
                  "name": "_digit"
                }
              ]
            }
          }
        ]
      }
    },
    "quantity": {
      "type": "SYMBOL",
      "name": "_number"
    },
    "neg_quantity": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "-"
        },
        {
          "type": "SYMBOL",
          "name": "_number"
        }
      ]
    },
    "commodity": {
      "type": "CHOICE",
      "members": [
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "\\p{L}+",
            "flags": "u"
          }
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "\\p{Sc}",
            "flags": "u"
          }
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PATTERN",
            "value": "\"[^\"\\n]*\""
          }
        }
      ]
    },
    "date": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_4d"
            },
            {
              "type": "SYMBOL",
              "name": "_dsep"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_dsep"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_dsep"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_dsep"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_dsep"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            }
          ]
        }
      ]
    },
    "_dsep": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[-\\.\\/]"
      }
    },
    "_2d": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "\\d{1,2}"
      }
    },
    "_4d": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "\\d{4}"
      }
    },
    "file_path": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_absolute_path"
        },
        {
          "type": "SYMBOL",
          "name": "_relative_path"
        }
      ]
    },
    "_absolute_path": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "/"
            },
            {
              "type": "PATTERN",
              "value": "[A-Za-z]:[\\\\\\/]"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_path_segments"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "_relative_path": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "./"
                },
                {
                  "type": "STRING",
                  "value": "../"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "_path_segments"
        }
      ]
    },
    "_path_segments": {
      "type": "SEQ",
      "members": [
        {
          "type": "PATTERN",
          "value": "[^\\s\\\\\\/]+"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "PATTERN",
                "value": "[\\\\\\/]"
              },
              {
                "type": "PATTERN",
                "value": "[^\\s\\\\\\/]+"
              }
            ]
          }
        }
      ]
    },
    "top_comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "STRING",
              "value": "#"
            }
          ]
        },
        {
          "type": "IMMEDIATE_TOKEN",
          "content": {
            "type": "REPEAT",
            "content": {
              "type": "PATTERN",
              "value": "[^\\n]"
            }
          }
        }
      ]
    },
    "_sep_comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_spacer"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_whitespace"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "comment"
        }
      ]
    },
    "comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": ";"
        },
        {
          "type": "IMMEDIATE_TOKEN",
          "content": {
            "type": "REPEAT",
            "content": {
              "type": "PATTERN",
              "value": "[^\\n]"
            }
          }
        }
      ]
    },
    "block_comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "comment"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "TOKEN",
                "content": {
                  "type": "PATTERN",
                  "value": "[^\\n\\r]+"
                }
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "PATTERN",
                    "value": "\\n"
                  },
                  {
                    "type": "PATTERN",
                    "value": "\\r"
                  },
                  {
                    "type": "PATTERN",
                    "value": "\\r\\n"
                  }
                ]
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": "end comment"
        }
      ]
    },
    "_whitechar": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": " "
        },
        {
          "type": "STRING",
          "value": "\t"
        }
      ]
    },
    "_newline": {
      "type": "PATTERN",
      "value": "\\n"
    },
    "_blank_line": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_whitespace"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "_newline"
        }
      ]
    },
    "_whitespace": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_whitechar"
        },
        {
          "type": "SYMBOL",
          "name": "_spacer"
        }
      ]
    },
    "_spacer": {
      "type": "PREC_RIGHT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "SYMBOL",
            "name": "_whitechar"
          },
          {
            "type": "REPEAT1",
            "content": {
              "type": "SYMBOL",
              "name": "_whitechar"
            }
          }
        ]
      }
    }
  },
  "extras": [],
  "conflicts": [],
  "precedences": [],
  "externals": [],
  "inline": [],
  "supertypes": [],
  "reserved": {}
}